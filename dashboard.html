<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>ComptaFlow - Dashboard</title>
<style>
body{
    font-family:Arial;
    background:#f4f6f9;
    text-align:center;
    padding-top:100px;
}
button{
    padding:10px 20px;
    background:#2a5298;
    color:white;
    border:none;
    border-radius:5px;
}
</style>
</head>
<body>

<h1>Bienvenue sur ComptaFlow ðŸŽ‰</h1>
<p>Connexion rÃ©ussie</p>

<button onclick="logout()">Se dÃ©connecter</button>

<script type="module">

import { initializeApp } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";

import { getAuth, signOut, onAuthStateChanged } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

import { getFirestore, doc, getDoc } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "TA_CLE_API",
  authDomain: "TON_AUTH_DOMAIN",
  projectId: "TON_PROJECT_ID",
  storageBucket: "TON_STORAGE_BUCKET",
  messagingSenderId: "TON_MESSAGING_ID",
  appId: "TON_APP_ID"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* ðŸ” PROTECTION SUPERADMIN */
onAuthStateChanged(auth, async (user) => {

  if (!user) {
    window.location.href = "index.html";
    return;
  }

  const userRef = doc(db, "utilisateurs", user.uid);
  const userSnap = await getDoc(userRef);

  if (!userSnap.exists()) {
    window.location.href = "index.html";
    return;
  }

  const userData = userSnap.data();

  if (userData.role !== "superadmin" || userData.actif !== true) {
    alert("AccÃ¨s refusÃ©");
    window.location.href = "index.html";
    return;
  }

  console.log("Superadmin connectÃ© âœ”");

});

/* ðŸ”“ LOGOUT */
window.logout = function() {
  signOut(auth).then(() => {
    window.location.href = "index.html";
  });
};


</script>

</body>
</html>
